## Smoke Test Backend IA

- **Base URL**: `https://api-ia.bodasdehoy.com`
- **Development**: `bodasdehoy`
- **Providers**: `auto`
- **Model (default)**: `openrouter/auto`
- **RequestId**: `smoke_20260120_200011_21634`
- **Fecha (UTC)**: `2026-01-20T19:00:11Z`

### 1) Health
```
HTTP/2 200 
date: Tue, 20 Jan 2026 19:00:11 GMT
content-type: application/json
content-length: 124
server: cloudflare
cf-cache-status: DYNAMIC
nel: {"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}
report-to: {"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=21rwqIRKWcaJjtK4nBpsqojkOsiZFMWK6t%2FhTRHKMx6m1vel%2FUshzi0HCBdOaczWwslMOLMtHvQJssJAUb9%2Fh5Y9ki3L05AoTymZDGy4z0Uvq0C5ng%3D%3D"}]}
cf-ray: 9c10d033de23c905-MAD
alt-svc: h3=":443"; ma=86400

{"status":"healthy","timestamp":"2026-01-20T19:00:11.786658","services":{"websockets":"0 active","graphql_proxy":"running"}}```

### 2) Models (auto)
```
HTTP/2 200 
date: Tue, 20 Jan 2026 19:00:12 GMT
content-type: application/json
content-length: 213
server: cloudflare
cf-cache-status: DYNAMIC
nel: {"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}
report-to: {"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=jPRydd2%2Fg%2BXa1%2FpWQkVMnRwtvBV89KQQw3jJi%2B%2Frn48amwvIIGihDBdxv2kifFJZBIy5SBuyDyxG1DOCq%2Fy%2Fl4NIq2rQz5%2Bvi0t1IPjiY9hYGKs%3D"}]}
cf-ray: 9c10d036aac8014a-MAD
alt-svc: h3=":443"; ma=86400

[{"id":"auto","name":"Auto - Selección automática","provider":"auto","context":128000,"maxOutput":4096,"description":"El sistema selecciona automáticamente el mejor provider según disponibilidad y criterios"}]```

### 3) Chat (auto) stream:false (esperado: JSON)
```
HTTP/2 200 
date: Tue, 20 Jan 2026 19:00:12 GMT
content-type: application/json
content-length: 201
server: cloudflare
cf-cache-status: DYNAMIC
nel: {"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}
report-to: {"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=2a1noghX6M5vVDBTgcPj3Xeral0qTnvV7jhpOgcKwM35Q7Dohk7Kqbkw1kcUA88feQ5FjvmpPEcuet6m4Z7U2N%2FQ0FCdK8tuj%2BszucELcGByCFI%3D"}]}
cf-ray: 9c10d0385c66038d-MAD
alt-svc: h3=":443"; ma=86400

{"success":true,"message":"Lo siento, no pude generar una respuesta. Por favor, intenta de nuevo.","metadata":{},"provider":"ollama","model":"qwen2.5:7b","tokens_used":0,"cost":0,"trace_id":"7d952eb1"}```

**Resultado:** ❌ FAIL — el backend devolvió mensaje fallback genérico (sin respuesta real).

### 4) Chat (auto) stream:true (esperado: SSE sin event:error)
```
HTTP/2 200 
date: Tue, 20 Jan 2026 19:00:13 GMT
content-type: text/event-stream; charset=utf-8
cache-control: no-cache
server: cloudflare
x-model: openrouter/auto
x-provider: ollama
cf-cache-status: DYNAMIC
nel: {"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}
report-to: {"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=xp1oqtnNGCK0PVrx7u%2F%2BdpWvgwDQnZ2kt%2Fgee4%2BQegiWHyXXggm%2BxSZC%2FOyACOTS%2BGl41CbANF8E57yNoO58sIL1eruvRQTvgj6ehm8QE3VlZpdpKw%3D%3D"}]}
cf-ray: 9c10d03bbe142aba-MAD
alt-svc: h3=":443"; ma=86400

event: error
data: {"error": "\u26a0\ufe0f Orchestrator fall\u00f3: Ollama no disponible"}

event: done
data: {}

```

**Resultado:** ❌ FAIL — stream contiene event: error.

### 5) API chat alternativa (/api/chat) (solo para comparar contrato)
```
HTTP/2 200 
date: Tue, 20 Jan 2026 19:00:14 GMT
content-type: application/json
content-length: 422
server: cloudflare
cf-cache-status: DYNAMIC
nel: {"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}
report-to: {"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=%2BFtlBXbUMVfO3f7QefyWvCpnnck5cWSSJsXKyK%2BnEGGkTusArR15lacEYqmZIrfeALsTwcJf2dGnDdOejnForAR%2FPTN3GnQb7sDhXbJdsMIt0sWH8g%3D%3D"}]}
cf-ray: 9c10d040bdf6cc51-MAD
alt-svc: h3=":443"; ma=86400

{"response":"Lo siento, hubo un error al procesar tu mensaje. Por favor, inténtalo de nuevo.","session_id":"sess_61f78c5e2ff4","requires_event_selection":false,"suggested_events":[],"metadata":{"tools_used":[],"tools_count":0,"response_time_ms":0,"billing":{},"provider":"ollama","model":"qwen2.5:14b","tokens_used":0,"real_cost":0.0,"billed_cost":0.0,"margin":0.0,"chat_config":{},"channel":"web","session_metadata":{}}}```

## Fin smoke test
- **RequestId**: `smoke_20260120_200011_21634`
- **Reporte**: `docs/reports/BACKEND_IA_SMOKE_smoke_20260120_200011_21634.md`
