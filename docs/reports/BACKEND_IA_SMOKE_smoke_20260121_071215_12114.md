## Smoke Test Backend IA

- **Base URL**: `https://api-ia.bodasdehoy.com`
- **Development**: `bodasdehoy`
- **Providers**: `auto`
- **Model (default)**: ``
- **RequestId**: `smoke_20260121_071215_12114`
- **Fecha (UTC)**: `2026-01-21T06:12:15Z`

### 1) Health
```
HTTP/2 200 
date: Wed, 21 Jan 2026 06:12:15 GMT
content-type: application/json
content-length: 124
server: cloudflare
cf-cache-status: DYNAMIC
nel: {"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}
report-to: {"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=jNmtDnZHh276IutEJJ3KoLh8%2B3DVRIBIs4Y1o%2BlHEECjbH2pn5QRvQuTmeMBll%2BSGzCoO7c%2Fx6PQeEBYUJwHOmVALM7MGyix1swHuHsubAweipgZDg%3D%3D"}]}
cf-ray: 9c14a8abef478df2-MAD
alt-svc: h3=":443"; ma=86400

{"status":"healthy","timestamp":"2026-01-21T06:12:15.637333","services":{"websockets":"0 active","graphql_proxy":"running"}}```

### 2) Models (auto)
```
HTTP/2 200 
date: Wed, 21 Jan 2026 06:12:16 GMT
content-type: application/json
content-length: 213
server: cloudflare
cf-cache-status: DYNAMIC
nel: {"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}
report-to: {"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=kjkY9ATIanxmdCBSzEb1x92UU3NhW9gG6kY2ZFgg%2Ftfib4qur3In5sGBtdPNKEXD7tMT3Ux6hYW6NGoPaFXJSKL%2ByNKY0ZaI%2FQuCPu5OS9PnkwjsyQ%3D%3D"}]}
cf-ray: 9c14a8aebd28f770-MAD
alt-svc: h3=":443"; ma=86400

[{"id":"auto","name":"Auto - Selección automática","provider":"auto","context":128000,"maxOutput":4096,"description":"El sistema selecciona automáticamente el mejor provider según disponibilidad y criterios"}]```

### 3) Chat (auto) stream:false (esperado: JSON)
```
HTTP/2 503 
date: Wed, 21 Jan 2026 06:12:16 GMT
content-type: application/json
content-length: 624
server: cloudflare
cf-cache-status: DYNAMIC
nel: {"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}
report-to: {"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=MX%2BbQmRckjp5quz3bu4JmbQ3e9WS7OWA%2FoKB4%2FvBj5%2FVLOZQ%2FHD%2BxtdoH%2B61Ffg%2B%2BeMOotBcvoRfNWjtroF%2BbTTUKGBBYm%2BT2DGLmhAh6I2dmo0%3D"}]}
cf-ray: 9c14a8b06c30cfc2-MAD
alt-svc: h3=":443"; ma=86400

{"success":false,"error":"No se pudo generar una respuesta. El orchestrator devolvió una respuesta vacía o genérica.","error_code":"EMPTY_RESPONSE","trace_id":"99dd7baa","provider":"ollama","model":"qwen2.5:7b","upstream_status":null,"timestamp":"2026-01-21T06:12:16.428812","suggestion":"Por favor, intenta de nuevo o verifica la configuración de providers.","metadata":{"error":"empty_response","original_result":"{'message': 'Lo siento, hubo un error al procesar tu mensaje. Por favor, inténtalo de nuevo.', 'error': 'Ollama no disponible', 'tokens_used': 0, 'cost': 0, 'provider': 'ollama', 'model': 'qwen2.5:7b'"}}```

**Resultado:** ✅ OK (503 esperado: EMPTY_RESPONSE).

### 4) Chat (auto) stream:true (esperado: SSE sin event:error, o 503 JSON estructurado)
```
HTTP/2 503 
date: Wed, 21 Jan 2026 06:12:17 GMT
content-type: application/json
content-length: 508
server: cloudflare
cf-cache-status: DYNAMIC
nel: {"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}
report-to: {"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=68HvYt77sVcLazyACHgcCKx02j4adS5%2FutRmBdtPUN7wn6rFc4UX8y4YM%2BKozVZQizrkG%2FIxSbWa%2BLLcjvWBeSpydtWCvsfbFUdZG5llhxZ0Ic38Ug%3D%3D"}]}
cf-ray: 9c14a8b3fb9a0341-MAD
alt-svc: h3=":443"; ma=86400

{"detail":{"error":"No hay proveedores disponibles. Por favor, configura al menos una API key (OpenAI, Anthropic, OpenRouter, etc.) o asegúrate de que Ollama esté corriendo.","error_code":"NO_PROVIDERS_AVAILABLE","trace_id":"8c73ac4f","provider":"auto","model":null,"upstream_status":null,"timestamp":"2026-01-21T06:12:17.264175","context":{"suggestion":"Por favor, configura al menos una API key (OPENAI_API_KEY, ANTHROPIC_API_KEY, OPENROUTER_API_KEY, etc.) o asegúrate de que Ollama esté corriendo."}}}```

**Resultado:** ✅ OK (503 esperado: NO_PROVIDERS_AVAILABLE).

### 5) API chat alternativa (/api/chat) (solo para comparar contrato)
```
HTTP/2 200 
date: Wed, 21 Jan 2026 06:12:18 GMT
content-type: application/json
content-length: 422
server: cloudflare
cf-cache-status: DYNAMIC
nel: {"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}
report-to: {"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=ZYFw6ffVq41C8gebjDdLRSVyiEd7F0536nNwgS8d6aZYjWCHgWrFtwmFwix6xYJN5NWZ2mIUY%2FeEDczdyF1Mz8usPz94p4MJnQC0vcaoMUvXtTJHlA%3D%3D"}]}
cf-ray: 9c14a8b8fc661a84-MAD
alt-svc: h3=":443"; ma=86400

{"response":"Lo siento, hubo un error al procesar tu mensaje. Por favor, inténtalo de nuevo.","session_id":"sess_9c93b0de9a8a","requires_event_selection":false,"suggested_events":[],"metadata":{"tools_used":[],"tools_count":0,"response_time_ms":0,"billing":{},"provider":"ollama","model":"qwen2.5:14b","tokens_used":0,"real_cost":0.0,"billed_cost":0.0,"margin":0.0,"chat_config":{},"channel":"web","session_metadata":{}}}```

## Fin smoke test
- **RequestId**: `smoke_20260121_071215_12114`
- **Reporte**: `docs/reports/BACKEND_IA_SMOKE_smoke_20260121_071215_12114.md`
